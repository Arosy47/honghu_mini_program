

<view style="position: absolute; top: 0;left: 0;">
  <cu-custom wx:if="{{showNavigate}}" bgColor="theme-color" isBack="{{true}}">
    
    <view slot="content">{{user.nickName}}的主页</view>
  </cu-custom>
</view>

<view id="top-trigger">
  
  <profile-card  wx:if="{{user}}" scroll-top="{{scrollDistence}}" user="{{user}}" visit="{{true}}" isSelf="{{user.userId==selfUserId}}" admin="{{user.admin}}" bind:followTap="onFollowTap" bind:gotoChatRoom="gotoChatRoom" bind:lookUserInfo="lookUserInfo" bind:moreAction="moreAction" bind:banUser="banUser" bind:unbanUser="unbanUser" />
</view>

<l-tabs wx:if="{{user}}" id="tabs" l-header-class="tabs {{tabsFixed ? 'tabs-fixed' : ''}}" sticktop="{{navHeight}}" l-line-class="tabs-line" animated animated-for-line active-color="#337559" bind:linchange="changeTabs" l-content-class="l-content-class">
	<l-tabpanel tab="话题" key="article" slot="article" content-height="{{swiper_height+100}}">
  
		<view style="{{tabsFixed ? 'margin-top: 80rpx;' : ''}}">
      <view wx:if="{{initLoading}}">
        <view class="cu-load loading text-gray" style="color: #666;"></view>
      </view>

      <nothing wx:if="{{user.hiddenArticle==true&&!initLoading&&selfUserId!=7777777}}" nothing-class="nothing" pic="../../images/icon_nothing/pic_topic.png" tip="用户设置帖子不可见" />

      <nothing wx:if="{{articleNodata&&!(user.hiddenArticle&&selfUserId!=7777777)&&!initLoading}}" nothing-class="nothing" pic="../../images/icon_nothing/pic_topic.png" tip="{{m.getGenderText(user.gender)}}还没有发布话题" />

      <view id="startarticle" class='start-view'></view>

      <topic-item wx:if="{{!(user.hiddenArticle==true&&selfUserId!=7777777) && (item.functionType=='NORMAL'||item.functionType=='VOTE'||item.functionType=='SECOND_HAND_MARKET'||item.functionType=='LOTTERY')}}" hover topic-item-class="topic-item" wx:for="{{userTopics}}" wx:key="id" topic="{{item}}" isOwner="{{userId === item.userId}}" admin="{{item.admin}}" data-index="{{index}}" bind:moreIconTap="showActions" bind:commentIconTap="gotoTopicDetail" bind:thumbUpIconTap="onThumbUpTap" 
      bind:collectIconTap="onCollectTap" bind:viewIconTap="gotoTopicDetail"
      bind:dingIconTap="onDingTap"
      bind:tagTap="gotoCategory" bind:vote="vote" bind:joinLottery="onJoinLottery"/>

      <view id="endarticle" class='start-view'></view>

      <l-loadmore l-class="loading" show="{{!initLoading&&loading}}" type="loading" loading-text="正在加载中..." line />
      <l-loadmore l-class="loading" show="{{!articleNodata&&!initLoading&&!userTopicHasMore && !loading&&!(user.hiddenArticle==true&&selfUserId!=7777777)}}" type="end" end-text="已经到底了" line />

		</view>
	</l-tabpanel>

	<l-tabpanel tab="收藏" key="collect" slot="collect" content-height="{{swiper_height+100}}">
		<view style="{{tabsFixed ? 'margin-top: 80rpx;' : ''}}">

      <view wx:if="{{initLoading}}">
        <view class="cu-load loading text-gray" style="color: #666;"></view>
      </view>

      <nothing wx:if="{{user.hiddenCollect==true&&!initLoading&&selfUserId!=7777777}}" nothing-class="nothing" pic="../../images/icon_nothing/pic_topic.png" tip="用户设置收藏不可见" />
      
      <nothing wx:if="{{!initLoading&&collectNodata&&!(user.hiddenCollect&&selfUserId!=7777777)}}" nothing-class="nothing" pic="../../images/icon_nothing/pic_topic.png" tip="TA还没有收藏话题" />

      <view id="startcollect" class='start-view'></view>

      <topic-item wx:if="{{!(user.hiddenCollect==true&&selfUserId!=7777777) && (item.functionType=='NORMAL'||item.functionType=='VOTE'||item.functionType=='SECOND_HAND_MARKET')}}" hover topic-item-class="topic-item" wx:for="{{userCollects}}" wx:key="id" topic="{{item}}" isOwner="{{userId === item.userId}}" admin="{{item.admin}}" data-index="{{index}}" bind:moreIconTap="showActions" bind:commentIconTap="gotoTopicDetail" bind:thumbUpIconTap="onThumbUpTap" 
      bind:collectIconTap="onCollectTap" bind:viewIconTap="gotoTopicDetail"
      bind:dingIconTap="onDingTap"
      bind:tagTap="gotoCategory" bind:vote="vote"/>

      <view id="endcollect" class='start-view'></view>

      <l-loadmore l-class="loading" show="{{!initLoading&&loading}}" type="loading" loading-text="正在加载中..." line />
      <l-loadmore l-class="loading" show="{{!collectNodata&&!initLoading&&!userCollectHasMore && !loading&&!(user.hiddenCollect==true&&selfUserId!=7777777)}}" type="end" end-text="已经到底了" line />

		</view>
	</l-tabpanel>
</l-tabs>

<van-action-sheet
  z-index="1026"
  show="{{ reportReasonShow }}"
  actions="{{ reportReasonList }}"
  bind:close="reportReasonListClose"
  bind:select="reportReasonSelect"
/>

<van-action-sheet
  z-index="1025"
  show="{{ actionsShow }}"
  actions="{{ actions }}"
  bind:close="actionClose"
  bind:select="actionSelect"
/>

<van-popup show="{{showPopup}}" bind:close="closePopup" position="bottom" custom-style="height: 10%">

  <view class="cu-form-group" bindtap="{{isBlacked?'unblackUser':'blackUser'}}">
    <view style="width: 100%; padding: 10rpx; display: flex; justify-content: center;">
      <view style="font-size: 30rpx;font-weight: bold;">{{isBlacked?'解除拉黑':'拉黑'}}</view>
    </view>
  </view>

</van-popup>

<wxs module="m">
	var getGenderText = function (gender) {
		if (gender === 1) {
			return "他"
		}
		else if (gender === 2) {
			return "她"
		}
		return "Ta"
	}
	module.exports = {
		getGenderText: getGenderText
	}
</wxs>